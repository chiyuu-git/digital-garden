---
{"dg-publish":true,"permalink":"/programming/basic/leetcode/297/","tags":["leetcode"]}
---


# [297. 二叉树的序列化与反序列化](https://leetcode.cn/problems/serialize-and-deserialize-binary-tree/)

# Similar Question

leading to the advanced question

# Solution Tips

# 方案

[297. 二叉树的序列化与反序列化](https://leetcode-cn.com/problems/serialize-and-deserialize-binary-tree/)

序列化是将一个数据结构或者对象转换为连续的比特位的操作，进而可以将转换后的数据存储在一个文件或者内存中，同时也可以通过网络传输到另一个计算机环境，采取相反方式重构得到原数据。

请设计一个算法来实现二叉树的序列化与反序列化。这里不限定你的序列 / 反序列化算法执行逻辑，你只需要保证一个二叉树可以被序列化为一个字符串并且将这个字符串反序列化为原始的树结构。

```
示例:
你可以将以下二叉树：
	 1
  / \
  2   3
     / \
    4   5
// 序列化为 "[1,2,3,null,null,4,5]"
```

提示: 这与 LeetCode 目前使用的方式一致，详情请参阅 LeetCode 序列化二叉树的格式。你并非必须采取这种方式，你也可以采用其他的方法解决这个问题。

说明: 不要使用类的成员 / 全局 / 静态变量来存储状态，你的序列化和反序列化算法应该是无状态的。

## 序列化

### 深度优先 - 先序遍历

![image.png](/img/user/programming/basic/data-structure/tree-traversal/22aa4f1f4325669c02d898729d72d5cd56cb47ea00d82528d4df15239ed46c35-image.png)

```js
var serialize = function (node, res = []) {
  if (node !== null) {
    res.push(node.val); //{1}
    serialize(node.left, res); //{2}
    serialize(node.right, res); //{3}
  } else {
    res.push(null);
  }
  // 序列化成字符串
  return res.toString();
};
```

字符串形式 null 被序列化成空位，更加节省空间

### 广度优先 - 层次遍历

```js
var serialize = function(root) {
  if(root===null) return JSON.stringify([null]
  const queue = [root]
  const res = []
  while(queue.length>0){
    const node = queue.shift()
    res.push(node.val)
    if(node.left!=null) queue.push(node.left)
    else res.push(null)

    if(node.right!=null) queue.push(node.right)
    else res.push(null)
  }
  // 序列化成JSON
  return JSON.stringify(res)
}
```

与层次遍历的区别在于叶节点的 null 也需要 push，用于标记树的结构

## 反序列化

### 解析 JSON

```js
var deserialize = function (data) {
  const serialize = JSON.parse(data);
  return recursion(serialize);
};
function recursion(arr) {
  if (arr[0] === null) return arr.shift();

  const root = new Node(arr.shift());
  root.left = recursion(arr);
  root.right = recursion(arr);

  return root;
}
```

### 解析字符串

`const serialize = data.split(',')`

null 被序列化为空 > `["2", "1", "", "", "4", "3", "", "", …]`

JSON 则是 `[1,2,null,null,3,4,null,null,5,null,null]`

```js
var deserialize = function (data) {
  const serialize = data.split(",");
  const rt = recursion(serialize);
  return rt;
  function recursion(arr) {
    if (arr[0] === "") {
      arr.shift();
      return null;
    }

    const root = new Node(arr.shift());
    root.left = recursion(arr);
    root.right = recursion(arr);

    return root;
  }
};
```
